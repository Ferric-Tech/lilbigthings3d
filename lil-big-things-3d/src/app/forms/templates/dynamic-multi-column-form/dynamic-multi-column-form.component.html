<div class="page-container">
  <div class="button-panel">
    <button mat-button [disabled]="!isValidForm" (click)="onSubmit()">
      Submit
    </button>
  </div>
</div>

<div class="page-container">
  <div *ngIf="config" class="screen-container">
    <div *ngFor="let column of config.columns" class="column-container">
      <form
        *ngFor="let form of column.forms"
        class="form-container"
        [formGroup]="forms[form.name]"
      >
        <div *ngFor="let field of form.fields">
          <!-- Form Labels -->
          <div
            *ngIf="
              field.type === formFieldType.MainLabel ||
              field.type === formFieldType.LabelSub ||
              field.type === formFieldType.UnderlinedLabel ||
              field.type === formFieldType.PlainLabel
            "
            class="form-line"
          >
            <div
              class="{{
                field.type === formFieldType.MainLabel
                  ? 'title'
                  : field.type === formFieldType.LabelSub
                  ? 'sub-title'
                  : field.type === formFieldType.UnderlinedLabel
                  ? 'underlined-title'
                  : ''
              }}"
            >
              {{ field.label }}
            </div>
          </div>

          <!-- Inputs -->
          <!-- Title -->
          <input
            *ngIf="field.type === formFieldType.InputTitle"
            formControlName="{{ field.name }}"
            class="title"
            id="{{ field.name }}"
            type="text"
            (focus)="onFieldFocus(forms[form.name], field.name)"
            (blur)="onFieldBlur(forms[form.name], field.name)"
          />

          <!-- Multi column -->
          <div
            *ngIf="
              field.type === formFieldType.InputMultiColumn &&
              field.multiColumnFieldSetting
            "
            class="form-line"
          >
            <div class="multi-column-field-label">{{ field.label }}</div>
            <div
              class="multi-column-field-column"
              *ngFor="let column of field.multiColumnFieldSetting"
            >
              <p>{{ column.label }}</p>
              <input
                formControlName="{{ column.name.toLowerCase() }}"
                id="{{ column.name.toLowerCase() }}"
                type="text"
              />
            </div>
          </div>

          <!-- Text areas -->
          <textarea
            *ngIf="field.type === formFieldType.InputTextShort"
            formControlName="{{ field.name }}"
            class="short-desc-area"
            id="{{ field.name }}"
            type="text"
            (focus)="onFieldFocus(forms[form.name], field.name)"
            (blur)="onFieldBlur(forms[form.name], field.name)"
            maxlength="{{
              field.characterLimit ? field.characterLimit : 'none'
            }}"
          ></textarea>

          <textarea
            *ngIf="field.type === formFieldType.InputTextLong"
            formControlName="{{ field.name }}"
            class="long-desc-area"
            id="{{ field.name }}"
            type="text"
            (focus)="onFieldFocus(forms[form.name], field.name)"
            (blur)="onFieldBlur(forms[form.name], field.name)"
          ></textarea>

          <!-- Main Image -->
          <div class="main-image-container">
            <img
              *ngIf="
                field.type === formFieldType.MainImage &&
                forms[form.name].controls[field.name].value
              "
              src="{{ forms[form.name].controls[field.name].value }}"
            />
          </div>

          <!-- File Uploaders -->
          <div
            *ngIf="
              field.type === formFieldType.UploaderMultiFilePlain ||
              field.type === formFieldType.UploaderMultiFileUnderlined ||
              field.type === formFieldType.UploaderSingleFilePlain ||
              field.type === formFieldType.UploaderSingleFileWithParams ||
              field.type === formFieldType.UploaderSingleFileUnderlined
            "
            class="form-line"
          >
            <div
              class="{{
                field.type === formFieldType.UploaderMultiFileUnderlined ||
                field.type === formFieldType.UploaderSingleFileUnderlined
                  ? 'underlined-title uploader-label'
                  : 'indented-text uploader-label'
              }}"
            >
              {{ field.label }}
            </div>
            <div class="uploader-file-name">
              {{ forms[form.name].value[field.name] }}
            </div>
            <input
              class="fake-file-selector"
              #designFileInput
              type="file"
              (change)="onFileSelection(forms[form.name], field.name, $event)"
            />
            <button
              class="file-selector-button"
              #upload
              (click)="designFileInput.click()"
            >
              Upload file
            </button>
          </div>

          <!-- Image Uploaders -->
          <div *ngIf="field.type === formFieldType.ImageUploader">
            <div class="form-line">
              <div class="uploader-label">
                {{ field.label }}
              </div>
              <input
                class="fake-file-selector"
                #designFileInput
                type="file"
                multiple
                (change)="
                  onImagesSelection(forms[form.name], field.name, $event)
                "
              />
              <button
                class="file-selector-button"
                #upload
                (click)="designFileInput.click()"
              >
                Upload images
              </button>
            </div>
            <div class="image-collection">
              <div
                *ngFor="let url of imageUrls[field.name]"
                class="image-container"
              >
                <img [src]="url" />
                <div class="overlay">
                  <button>Delete</button>
                  <button (click)="setPrimaryImage(url)">Make primary</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Dialogs  -->
<app-print-file-parameters-dialog
  *ngIf="showPrintFileParameterDialog"
></app-print-file-parameters-dialog>
